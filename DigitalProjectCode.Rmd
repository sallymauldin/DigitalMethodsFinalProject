---
title: "History8550DigitalProjectCode"
author: "Sally Mauldin"
date: "2023-09-30"
output:
  html_document: default
  pdf_document: default
---
---
<style type="text/css">
h6 { /* Header 6 */
 font-size: 10px;
 color: black;
 text-align: center
}
</style>

### Network of Colleges and Universities in South Carolina in the 19th Century

This visualization is a network of individuals associated with 22 higher education institutions in South Carolina in the 19th century. Each icon (node) represents one college/university, and the connections (edges) between icons indicate known associations, such as founders, presidents, and board members. 
```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
#Load libraries
library(visNetwork)
library(igraph) 
library(dplyr)
library(tidyr)
```

````{r, message=FALSE, warning=FALSE, echo=FALSE}
#Create edges and nodes from CSV files
edges <- read.csv("edges.version5.csv", stringsAsFactors = FALSE) 
edges <- as.data.frame(edges)

nodes <- read.csv("nodes.version5.csv", stringsAsFactors = FALSE) 
nodes <- as.data.frame(nodes)
````

````{r, message=FALSE, warning=FALSE, echo=FALSE}
#Create a column assigning colors to institutional relationships like President and Board Member
edges <- edges %>%
  mutate(title = edges$Institution.Roles[1:302]) %>%
  mutate(color = ifelse(edges$Institution.Roles == "Benefactor", "green",
                        ifelse(edges$Institution.Roles == "Board Member", "blue",
                               ifelse(edges$Institution.Roles == "President", "red",
                                      ifelse(edges$Institution.Roles == "Key Figure", "darkgreen",
                                                                                       ifelse(edges$Institution.Roles == "Founder", "purple",
                                                                                              ifelse(edges$Institution.Roles == "Namesake", "turquoise", "gray")))))))
````

````{r, message=FALSE, warning=FALSE, echo=FALSE}
#Customize the nodes by color in network. Nodes are all of the people and each of the 22 institutions. Total of 317 nodes.
nodes <- nodes %>%
  mutate(shape = ifelse(nodes$Political.Roles == "Legislator", "square",
                        ifelse(nodes$Political.Roles == "Founding Father,Legislator", "diamond",
                               ifelse(nodes$Political.Roles == "Legislator,Governor", "triangle",
                                      ifelse(nodes$Political.Roles == "Foreign Ambassador,Founding Father,Legislator", "diamond",
                                             ifelse(nodes$Political.Roles == "Lt. Governor,Legislator", "square",
                                                    ifelse(nodes$Political.Roles == "Founding Father,Governor,Legislator", "diamond",
                                                           ifelse(nodes$Political.Roles == "Governor,Legislator", "triangle",
                                                                  ifelse(nodes$Political.Roles == "Governor's Staff,Legislator", "square",
                                                                         ifelse(nodes$Political.Roles == "Governor", "star",
                                                                                ifelse(nodes$Political.Roles == "Founding Father,Judge,Governor,Legislator", "diamond",
                                                                                       ifelse(nodes$Political.Roles == "Foreign Ambassador,Legislator", "square",
                                                                                              ifelse(nodes$Political.Roles == "Legislator,Governor's Staff", "square",
                                                                                                     ifelse(nodes$Political.Roles == "Judge,Legislator", "square",
                                                                                                            ifelse(nodes$Political.Roles == "Foreign Ambassador", "open oval", "circle"
                                                                              )))))))))))))))%>%
  mutate(title = (nodes$id[1:317])) %>%
  mutate(color = ifelse(nodes$Type == "Person", "navy",
                        ifelse(nodes$Type == "Institution", "orange", "tan")))
                               
      
````


```{r}
#Make data frames for edge and node legends
ledges <- data.frame(color = c("green", "blue", "red", "darkgreen", "purple", "turquoise"),
                     label = c("Benefactor", "Board Member", "President", "Key Figure", "Founder", "Namesake"))

lnodes <- data.frame(label = c("Person", "Institution"),
                    color = c("navy", "orange"),
                   ID = 1:2) 
```


```{r, echo=FALSE}
#Create network visualization
edges <- edges %>% rename(from = ID, to = ID.1)


visNetwork(nodes = nodes, edges = edges, height = 650, width = 1100) %>%
  visIgraphLayout(layout = "layout_with_fr", randomSeed = 12) %>% 
  visNodes(size = 36, 
           label = paste(nodes$id),
           title = title,
           font = list("size" = 20)) %>%
  visEdges(color = list(color = edges$color, opacity = 0.2),
           hoverWidth = 20,
           selectionWidth = 36) 


```
 

 
```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
```


